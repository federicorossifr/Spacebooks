

<body onload="init()">
	<button id="get" >Get</button><img id="loader" src="./img/ajax-loader.gif" style="display:none">
	Content:
	<input type="text" id="filter">
	Field:
	<select id="field">
		<option value="0">Id</option>
		<option value="1">Name</option>
		<option value="2">Times</option>
		<option value="3">Last</option>
	</select>
	<table>
		<thead>
			<th>Id</th>
			<th>Name</th>
			<th>Times</th>
			<th>Last</th>
		</thead>

		<tbody id="out">
			
		</tbody>

	</table>
</body>

<script type="text/javascript" src="./js/Async.js"></script>
<script type="text/javascript" src="./js/DataUtilities.js"></script>
<script type="text/javascript">



	function init() {
		var START = 0;
		var SIZE = 5;
		var loader = document.getElementById("loader");
		var filter = document.getElementById("filter");
		var field = document.getElementById("field");
		var dataTable = document.getElementById("out");
		var get = document.getElementById("get");
		get.onclick = getAndDisplay;
		
		function callback(data) {
			var jsonData = JSON.parse(data);
			console.log(data);
			matrixToTable(jsonData,dataTable);
			START+= jsonData.length;
			loader.style.display = "none";

			if(!applyFilters() && jsonData.length != 0) getAndDisplay();
		}


		function getAndDisplay() {
			loader.style.display = "inline";
			var params = [{'id':'fw','value':START},{'id':'hw','value':SIZE}];
			DataLoad("./php/test.php",params,callback);
		}

		function applyFilters() {
			var fieldNumber = Number(field.value);
			var text = filter.value;
			return filterTable(dataTable,fieldNumber,text);
		}

		filter.oninput = function(event) {
			var count = applyFilters();
			if(!count) getAndDisplay();
		}

		field.onchange = function(event) {
			 var count = applyFilters();
			 if(!count) getAndDisplay();
		}
	}

	init();

</script>