<h1>Inputs</h1>
<link rel="stylesheet" type="text/css" href="css/test.css">

<div id="initial" class="fileInput fileUploader">
	<input type="file" name="file[]">
	<span>Nessun file</span>
</div>
<button onclick="multiUp.addUploader(this)">Add another file</button>


<script type="text/javascript">
	function multiUploader(firstUploader) {
		this.entryPoint = document.getElementById(firstUploader);
		this.entryLabel = this.entryPoint.querySelector("span");
		this.parentElement = this.entryPoint.parentElement;

		with(this) {
			var input = entryPoint.querySelector("input[type='file']");
			input.onchange = function(e) {
				entryLabel.textContent = e.target.files[0].name + " Size(kb):" + e.target.files[0].size / 1000;
			}
			entryPoint.onclick = function() {
				input.click();
			}
		}
	}

	multiUploader.prototype.addUploader = function(caller) {
		with(this) {
			var newUploader = document.createElement("div");
			newUploader.className = "fileInput fileUploader";
			var label = document.createElement("span");
			label.textContent = "Nessun file";
			var fileInput = document.createElement("input");
			fileInput.type ="file";
			fileInput.name ="file[]";
			newUploader.appendChild(fileInput);
			newUploader.appendChild(label);
			parentElement.insertBefore(newUploader,caller);

			newUploader.onclick = function() {
				fileInput.click();
			}

			fileInput.onchange = function(e) {
				label.textContent = e.target.files[0].name + " Size(kb):" + e.target.files[0].size / 1000;
			}
		}

	}

	var multiUp = new multiUploader("initial");
</script>